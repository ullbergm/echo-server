---
# Example Certificate resource for cert-manager
# This demonstrates how to automatically provision TLS certificates using cert-manager
# Prerequisites: cert-manager must be installed in your cluster
# See: https://cert-manager.io/docs/installation/

apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: echo-server-tls
  labels:
    app: echo-server
spec:
  # Secret name where certificate will be stored
  secretName: echo-server-tls
  
  # Duration before the certificate expires (default: 90 days)
  duration: 2160h # 90 days
  
  # Duration before renewal (default: 30 days before expiry)
  renewBefore: 360h # 15 days
  
  # Subject configuration
  subject:
    organizations:
      - Echo Server
  
  # Common Name (CN) for the certificate
  commonName: echo-server.example.com
  
  # DNS names the certificate is valid for
  dnsNames:
    - echo-server.example.com
    - echo-server
    - echo-server.default.svc.cluster.local
  
  # Reference to the Issuer (replace with your issuer)
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
    # Or use a namespace-scoped Issuer:
    # kind: Issuer
  
  # Private key configuration
  privateKey:
    algorithm: RSA
    encoding: PKCS1
    size: 2048

---
# Example ClusterIssuer for Let's Encrypt
# Uncomment and configure this if you don't have an issuer set up
# apiVersion: cert-manager.io/v1
# kind: ClusterIssuer
# metadata:
#   name: letsencrypt-prod
# spec:
#   acme:
#     # The ACME server URL
#     server: https://acme-v02.api.letsencrypt.org/directory
#     # Email address for ACME registration
#     email: your-email@example.com
#     # Name of a secret used to store the ACME account private key
#     privateKeySecretRef:
#       name: letsencrypt-prod
#     # ACME DNS-01 or HTTP-01 challenge
#     solvers:
#     - http01:
#         ingress:
#           class: nginx

---
# Example self-signed Issuer for testing
# Use this for development/testing environments
# apiVersion: cert-manager.io/v1
# kind: Issuer
# metadata:
#   name: selfsigned-issuer
#   namespace: default
# spec:
#   selfSigned: {}
